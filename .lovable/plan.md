
# แผนการเพิ่ม Distribution View ในหน้า Admin Dashboard

## สรุปภาพรวม
เพิ่มมุมมองการกระจายตัวของคะแนน (Distribution View) เพื่อให้แอดมินเห็นภาพที่ชัดเจนกว่าค่าเฉลี่ย โดยแสดงจำนวนคนที่เลือกแต่ละคะแนน 1-5 และเพิ่มตัวชี้วัดใหม่ 2 ตัว

---

## สิ่งที่จะได้หลังทำเสร็จ

| ฟีเจอร์ | รายละเอียด |
|---------|------------|
| Histogram Chart | กราฟแท่งแสดงจำนวนคนเลือกคะแนน 1-5 แยกต่อข้อ |
| % กลุ่มไม่พอใจ | แสดง % ของคนที่ให้คะแนน 1-2 (สีแดง/เหลืองเตือน) |
| Median Score | ค่ากลางของคะแนนทั้งหมด (ตัดปัญหา outlier) |

---

## ขั้นตอนการพัฒนา

### 1. สร้าง Component ใหม่: DistributionChart.tsx
**ไฟล์:** `src/components/admin/DistributionChart.tsx`

- สร้างกราฟ Histogram ใช้ Recharts (BarChart)
- มี Tabs ให้เลือกดูแต่ละข้อ (ข้อ 1 - ข้อ 5)
- แต่ละข้อแสดงแท่ง 5 แท่ง (คะแนน 1-5)
- สีแท่งตามระดับ: 1-2 = แดง/ส้ม, 3 = เหลือง, 4-5 = เขียว
- แสดงจำนวนคนบนแท่ง

### 2. ปรับปรุง StatsCards.tsx
**ไฟล์:** `src/components/admin/StatsCards.tsx`

เพิ่มการ์ดใหม่ 2 ใบ:
- **การ์ด "กลุ่มไม่พอใจ"**: แสดง % คนให้คะแนน 1-2 พร้อมไอคอนเตือน
- **การ์ด "Median"**: แสดงค่ากลางของคะแนนรวม

### 3. อัพเดท Admin.tsx
**ไฟล์:** `src/pages/Admin.tsx`

เพิ่มการคำนวณ stats ใหม่:
- `distribution`: นับจำนวนคนเลือกแต่ละคะแนนต่อข้อ
- `dissatisfiedPercent`: % ของ response ที่มีค่าเฉลี่ย <= 2
- `median`: ค่ากลางของคะแนนเฉลี่ยทั้งหมด

---

## รายละเอียดทางเทคนิค

### โครงสร้างข้อมูล Distribution
```text
distribution: {
  q1: { 1: 5, 2: 3, 3: 10, 4: 20, 5: 15 },
  q2: { 1: 2, 2: 4, 3: 8,  4: 25, 5: 14 },
  ...
}
```

### สูตรคำนวณ

**% กลุ่มไม่พอใจ:**
```text
นับ response ที่ค่าเฉลี่ย <= 2 / จำนวน response ทั้งหมด * 100
```

**Median:**
```text
1. เรียงค่าเฉลี่ยของทุก response จากน้อยไปมาก
2. ถ้าจำนวนคี่: เลือกตัวกลาง
3. ถ้าจำนวนคู่: เฉลี่ยค่า 2 ตัวกลาง
```

### Layout หน้า Admin (หลังปรับ)
```text
+--------------------------------------------------+
|  StatsCards (5 การ์ด)                            |
|  [ผู้ตอบ] [เฉลี่ย] [พึงพอใจ%] [ไม่พอใจ%] [Median] |
+--------------------------------------------------+
|  [AverageChart]     |  [DistributionChart]       |
|  ค่าเฉลี่ยรายข้อ      |  การกระจายคะแนน            |
+--------------------------------------------------+
|  ResponsesTable                                  |
+--------------------------------------------------+
```

---

## ไฟล์ที่ต้องแก้ไข

| ไฟล์ | การเปลี่ยนแปลง |
|------|---------------|
| `src/components/admin/DistributionChart.tsx` | สร้างใหม่ - Histogram component |
| `src/components/admin/StatsCards.tsx` | เพิ่มการ์ด % ไม่พอใจ และ Median |
| `src/pages/Admin.tsx` | เพิ่มการคำนวณ distribution, median, dissatisfiedPercent |

---

## ประมาณการ
- **ระดับความยาก:** ปานกลาง
- **เวลาดำเนินการ:** ประมาณ 15-20 นาที
- **Dependencies:** ใช้ Recharts ที่มีอยู่แล้ว + Radix Tabs ที่มีอยู่แล้ว
